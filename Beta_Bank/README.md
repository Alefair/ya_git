# Прогнозирование оттока клиентов в "βeta-Банк"

![logo](https://raw.githubusercontent.com/Alefair/ya_git/master/Beta_Bank/beta_logo.PNG)

```
βeta-Банк просит проанализировать данные и спрогнозировать, уйдет ли клиент из банка или нет.

Есть информация, что из банка стали уходить клиенты. Каждый месяц. Немного, но заметно. 
Банковские маркетологи посчитали: сохранять текущих клиентов дешевле, чем привлекать новых.

Предоставлены исторические данные о поведении клиентов и расторжении договоров с банком.


Модель с предельно большим значением F1-меры, как минимум 0.59, может помочь.

Также необходимо проверить F1-меру на тестовой выборке, измерить AUC-ROC и 
сравнить её значение с F1-мерой.
```

[Источник данных](https://www.kaggle.com/barelydedicated/bank-customer-churn-modeling)

<hr>

## Результат исследования:

**Данные**

- считали файл

- изучили данные

- дублей не обнаружено

- но зато нашли и исправили пропуски

- удалили лишние столбцы, которые не влияют на посещаимость банка

- преобразовали значения столбцов "Gender" и "Geography" в численные

- разбили данные на обучающие, валидационную и тренировочную выборку

- проверили на размер полученные данные

- стандартизировали данные методом StandardScaler

<br>

**Исследование задачи**

- получили значения F1 и AUC_ROC для Логистической регрессии, Решающего дерева и Случайного леса

- получили эти же метрики для сблансированных моделей и получили лучше показатели

- получили эти же метрики и проверили порог классификации

- проверили модель на адекватность и протестировали

<br>

**Резюме**

В проекте лучшей моделью выбрана модель случайного леса, с параметром **n_estimators=73**

и с параметром **class_weight="balanced"**


Данная модель выбрана с порогом точности **0.32**


Валидационная выборка:
**F1_score: 0.616**
**AUC-ROC: 0.842**


------------------------------


Тестовая выборка:
**F1_score: 0.606**
**AUC-ROC: 0.849**


Требование метрики **F1** не ниже **0.59** выполнено!
